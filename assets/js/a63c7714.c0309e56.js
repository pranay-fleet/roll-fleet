"use strict";(globalThis.webpackChunkdocs_roll=globalThis.webpackChunkdocs_roll||[]).push([[4181],{654:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>s});var a=t(8168),l=(t(6540),t(5680));const r={},i="ROLL x Ascend",o={unversionedId:"English/UserGuide/ascend/ascend_usage",id:"English/UserGuide/ascend/ascend_usage",title:"ROLL x Ascend",description:"Last updated: 09/28/2025.",source:"@site/docs/English/UserGuide/ascend/ascend_usage.md",sourceDirName:"English/UserGuide/ascend",slug:"/English/UserGuide/ascend/ascend_usage",permalink:"/ROLL/docs/English/UserGuide/ascend/ascend_usage",draft:!1,editUrl:"https://github.com/alibaba/ROLL/tree/main/docs_roll/docs/English/UserGuide/ascend/ascend_usage.md",tags:[],version:"current",lastUpdatedAt:1761384892,formattedLastUpdatedAt:"Oct 25, 2025",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"TOPR (Tapered Off-Policy REINFORCE)",permalink:"/ROLL/docs/English/UserGuide/algorithms/TOPR"},next:{title:"Agentic Asynchronous Training Feature Usage Guide",permalink:"/ROLL/docs/English/UserGuide/async_training_agentic"}},p={},s=[{value:"Hardware Support",id:"hardware-support",level:2},{value:"Installation",id:"installation",level:2},{value:"Basic Environment Setup",id:"basic-environment-setup",level:3},{value:"Create Conda Environment",id:"create-conda-environment",level:3},{value:"Install torch &amp; torch_npu",id:"install-torch--torch_npu",level:3},{value:"Install vllm &amp; vllm-ascend",id:"install-vllm--vllm-ascend",level:3},{value:"Install ROLL",id:"install-roll",level:3},{value:"Additional Third-Party Libraries",id:"additional-third-party-libraries",level:3},{value:"Quick Start: Single-Node Deployment",id:"quick-start-single-node-deployment",level:2},{value:"Current Support Status",id:"current-support-status",level:2},{value:"Disclaimer",id:"disclaimer",level:2}],d={toc:s},g="wrapper";function c({components:e,...n}){return(0,l.yg)(g,(0,a.A)({},d,n,{components:e,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"roll-x-ascend"},"ROLL x Ascend"),(0,l.yg)("p",null,"Last updated: 09/28/2025."),(0,l.yg)("p",null,"We have added support for Huawei Ascend devices in ROLL."),(0,l.yg)("h2",{id:"hardware-support"},"Hardware Support"),(0,l.yg)("p",null,"Atlas 900 A2 PODc"),(0,l.yg)("h2",{id:"installation"},"Installation"),(0,l.yg)("h3",{id:"basic-environment-setup"},"Basic Environment Setup"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"Software"),(0,l.yg)("th",{parentName:"tr",align:null},"Version"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Python"),(0,l.yg)("td",{parentName:"tr",align:null},"3.10")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"CANN"),(0,l.yg)("td",{parentName:"tr",align:null},"8.1.RC1")))),(0,l.yg)("h3",{id:"create-conda-environment"},"Create Conda Environment"),(0,l.yg)("p",null,"Use the following commands to create a new conda environment in Miniconda:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"conda create --name roll python=3.10\nconda activate roll\n")),(0,l.yg)("h3",{id:"install-torch--torch_npu"},"Install torch & torch_npu"),(0,l.yg)("p",null,"To use torch and torch_npu in ROLL, install them using the commands below:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# Install CPU version of torch\npip install torch==2.5.1 torchvision==0.20.1 torchaudio==2.5.1 --index-url https://download.pytorch.org/whl/cpu\n\n# Install torch_npu\npip install torch_npu==2.5.1\n")),(0,l.yg)("h3",{id:"install-vllm--vllm-ascend"},"Install vllm & vllm-ascend"),(0,l.yg)("p",null,"To use vllm in ROLL, compile and install vllm and vllm-ascend as follows:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# vllm\ngit clone -b v0.8.4 --depth 1 https://github.com/vllm-project/vllm.git\ncd vllm\n\nVLLM_TARGET_DEVICE=empty pip install -v -e .\ncd ..\n# vllm-ascend\ngit clone -b v0.8.4rc2 --depth 1 https://github.com/vllm-project/vllm-ascend.git\ncd vllm-ascend\n\nexport COMPILE_CUSTOM_KERNELS=1\npip install -e .\ncd ..\n")),(0,l.yg)("p",null,"If you encounter an error like this during the vllm-ascend installation:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"RuntimeError: CMake configuration failed: Command '['/pathto/miniconda3/envs/roll/bin/python3.10', '-m', 'pybind11', '--cmake']' returned non-zero exit status 2.\n")),(0,l.yg)("p",null,"Try modifying lines 151\u2013158 in ",(0,l.yg)("inlineCode",{parentName:"p"},"setup.py")," under the vllm-ascend directory as follows, then recompile:"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},'try:\n    # if pybind11 is installed via pip\n    pybind11_cmake_path = (subprocess.check_output(\n        [python_executable, "-m", "pybind11",\n        "--cmakedir"]).decode().strip())\nexcept subprocess.CalledProcessError as e:\n    # else specify pybind11 path installed from source code on CI container\n    raise RuntimeError(f"CMake configuration failed: {e}")\n')),(0,l.yg)("h3",{id:"install-roll"},"Install ROLL"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"git clone https://github.com/alibaba/ROLL.git\ncd ROLL\npip install -r requirements_common.txt\npip install deepspeed==0.16.0\ncd ..\n")),(0,l.yg)("h3",{id:"additional-third-party-libraries"},"Additional Third-Party Libraries"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"Software"),(0,l.yg)("th",{parentName:"tr",align:null},"Description"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"transformers"),(0,l.yg)("td",{parentName:"tr",align:null},"v4.52.4")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"flash_attn"),(0,l.yg)("td",{parentName:"tr",align:null},"not supported")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"transformer-engine","[pytorch]"),(0,l.yg)("td",{parentName:"tr",align:null},"not supported")))),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"transformers")," v4.52.4 supports enabling ",(0,l.yg)("inlineCode",{parentName:"li"},"--flash_attention_2"),"."),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"flash_attn")," acceleration is not supported."),(0,l.yg)("li",{parentName:"ol"},(0,l.yg)("inlineCode",{parentName:"li"},"transformer-engine[pytorch]")," is currently not supported.")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"pip install transformers==4.52.4\n")),(0,l.yg)("h2",{id:"quick-start-single-node-deployment"},"Quick Start: Single-Node Deployment"),(0,l.yg)("p",null,"Before full usage, we recommend testing the single-node pipeline to verify your environment and installation.\nSince Megatron-LM training is not yet supported, first change ",(0,l.yg)("inlineCode",{parentName:"p"},"strategy_args")," in the relevant files to use the ",(0,l.yg)("inlineCode",{parentName:"p"},"deepspeed")," option."),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"Run the single-node pipeline via shell:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"bash examples/agentic_demo/run_agentic_pipeline_frozen_lake_single_node_demo.sh  \n")),(0,l.yg)("ol",{start:2},(0,l.yg)("li",{parentName:"ol"},"Run the agentic pipeline using a config file:")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# Make sure you are in the root directory of the ROLL project\n# export PYTHONPATH=$(pwd):$PYTHONPATH\n\npython examples/start_agentic_pipeline.py \\\n        --config_path qwen2.5-0.5B-agentic \\\n        --config_name agentic_val_sokoban\n")),(0,l.yg)("ul",null,(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"--config_path")," \u2013 Directory containing your YAML configuration files."),(0,l.yg)("li",{parentName:"ul"},(0,l.yg)("inlineCode",{parentName:"li"},"--config_name")," \u2013 Filename (without the ",(0,l.yg)("inlineCode",{parentName:"li"},".yaml")," extension).")),(0,l.yg)("h2",{id:"current-support-status"},"Current Support Status"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"Feature"),(0,l.yg)("th",{parentName:"tr",align:null},"Example"),(0,l.yg)("th",{parentName:"tr",align:null},"Training Backend"),(0,l.yg)("th",{parentName:"tr",align:null},"Inference Backend"),(0,l.yg)("th",{parentName:"tr",align:null},"Hardware"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Agentic"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-0.5B-agentic/run_agentic_pipeline_sokoban.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Agentic-Rollout"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-0.5B-agentic/run_agentic_rollout_sokoban.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"DPO"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-3B-dpo_megatron/run_dpo_pipeline.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"RLVR"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-7B-rlvr_megatron/run_rlvr_pipeline.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")))),(0,l.yg)("h2",{id:"disclaimer"},"Disclaimer"),(0,l.yg)("p",null,"The Ascend support provided in ROLL is intended as a reference example. For production use, please consult official channels."))}c.isMDXComponent=!0},5680:(e,n,t)=>{t.d(n,{xA:()=>d,yg:()=>m});var a=t(6540);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){l(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function o(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},g="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef(function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),g=s(t),u=l,m=g["".concat(p,".").concat(u)]||g[u]||c[u]||r;return t?a.createElement(m,i(i({ref:n},d),{},{components:t})):a.createElement(m,i({ref:n},d))});function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,i=new Array(r);i[0]=u;var o={};for(var p in n)hasOwnProperty.call(n,p)&&(o[p]=n[p]);o.originalType=e,o[g]="string"==typeof e?e:l,i[1]=o;for(var s=2;s<r;s++)i[s]=t[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"}}]);