"use strict";(globalThis.webpackChunkdocs_roll=globalThis.webpackChunkdocs_roll||[]).push([[4516],{4051:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>p,default:()=>y,frontMatter:()=>r,metadata:()=>o,toc:()=>g});var a=t(8168),l=(t(6540),t(5680));const r={},p="ROLL x Ascend",o={unversionedId:"\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/ascend/ascend_usage",id:"\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/ascend/ascend_usage",title:"ROLL x Ascend",description:"Last updated: 09/28/2025.",source:"@site/docs/\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/ascend/ascend_usage.md",sourceDirName:"\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/ascend",slug:"/\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/ascend/ascend_usage",permalink:"/ROLL/docs/\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/ascend/ascend_usage",draft:!1,editUrl:"https://github.com/alibaba/ROLL/tree/main/docs_roll/docs/\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/ascend/ascend_usage.md",tags:[],version:"current",lastUpdatedAt:1761386293,formattedLastUpdatedAt:"Oct 25, 2025",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"RL options \u5927\u5168",permalink:"/ROLL/docs/\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/algorithms/rl_options"},next:{title:"DeepSpeed \u8bad\u7ec3\u540e\u7aef\u914d\u7f6e\u6307\u5357",permalink:"/ROLL/docs/\u7b80\u4f53\u4e2d\u6587/\u4f7f\u7528\u6307\u5357/backend/deepspeed"}},i={},g=[{value:"\u786c\u4ef6\u652f\u6301",id:"\u786c\u4ef6\u652f\u6301",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u57fa\u7840\u73af\u5883\u51c6\u5907",id:"\u57fa\u7840\u73af\u5883\u51c6\u5907",level:3},{value:"\u521b\u5efa conda \u73af\u5883",id:"\u521b\u5efa-conda-\u73af\u5883",level:3},{value:"\u5b89\u88c5 torch &amp; torch_npu:",id:"\u5b89\u88c5-torch--torch_npu",level:3},{value:"\u5b89\u88c5vllm &amp; vllm-ascend:",id:"\u5b89\u88c5vllm--vllm-ascend",level:3},{value:"\u5b89\u88c5 ROLL",id:"\u5b89\u88c5-roll",level:3},{value:"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e",id:"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e",level:3},{value:"\u5feb\u901f\u5f00\u59cb\uff0c\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15",id:"\u5feb\u901f\u5f00\u59cb\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15",level:2},{value:"\u652f\u6301\u73b0\u72b6",id:"\u652f\u6301\u73b0\u72b6",level:2},{value:"\u58f0\u660e",id:"\u58f0\u660e",level:2}],d={toc:g},c="wrapper";function y({components:e,...n}){return(0,l.yg)(c,(0,a.A)({},d,n,{components:e,mdxType:"MDXLayout"}),(0,l.yg)("h1",{id:"roll-x-ascend"},"ROLL x Ascend"),(0,l.yg)("p",null,"Last updated: 09/28/2025."),(0,l.yg)("p",null,"\u6211\u4eec\u5728 ROLL \u4e0a\u589e\u52a0\u5bf9\u534e\u4e3a\u6607\u817e\u8bbe\u5907\u7684\u652f\u6301\u3002"),(0,l.yg)("h2",{id:"\u786c\u4ef6\u652f\u6301"},"\u786c\u4ef6\u652f\u6301"),(0,l.yg)("p",null,"Atlas 900 A2 PODc"),(0,l.yg)("h2",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,l.yg)("h3",{id:"\u57fa\u7840\u73af\u5883\u51c6\u5907"},"\u57fa\u7840\u73af\u5883\u51c6\u5907"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"software"),(0,l.yg)("th",{parentName:"tr",align:null},"version"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Python"),(0,l.yg)("td",{parentName:"tr",align:null},"3.10")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"CANN"),(0,l.yg)("td",{parentName:"tr",align:null},"8.1.RC1")))),(0,l.yg)("h3",{id:"\u521b\u5efa-conda-\u73af\u5883"},"\u521b\u5efa conda \u73af\u5883"),(0,l.yg)("p",null,"\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728 Miniconda \u4e2d\u521b\u5efa\u65b0\u7684 conda \u73af\u5883\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"conda create --name roll python=3.10\nconda activate roll\n")),(0,l.yg)("h3",{id:"\u5b89\u88c5-torch--torch_npu"},"\u5b89\u88c5 torch & torch_npu:"),(0,l.yg)("p",null,"\u4e3a\u4e86\u80fd\u5728 ROLL \u4e2d\u6b63\u5e38\u4f7f\u7528 torch \u548c torch_npu\uff0c\u9700\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5 torch \u548c torch_npu\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# \u5b89\u88c5 torch \u7684 CPU \u7248\u672c\npip install torch==2.5.1 torchvision==0.20.1 torchaudio==2.5.1 --index-url https://download.pytorch.org/whl/cpu\n\n# \u5b89\u88c5 torch_npu\npip install torch_npu==2.5.1\n")),(0,l.yg)("h3",{id:"\u5b89\u88c5vllm--vllm-ascend"},"\u5b89\u88c5vllm & vllm-ascend:"),(0,l.yg)("p",null,"\u4e3a\u4e86\u80fd\u591f\u5728 ROLL \u4e2d\u6b63\u5e38\u4f7f\u7528 vllm\uff0c\u9700\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u7f16\u8bd1\u5b89\u88c5 vllm \u548c vllm-ascend\u3002"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# vllm\ngit clone -b v0.8.4 --depth 1 https://github.com/vllm-project/vllm.git\ncd vllm\n\nVLLM_TARGET_DEVICE=empty pip install -v -e .\ncd ..\n")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# vllm-ascend\ngit clone -b v0.8.4rc2 --depth 1 https://github.com/vllm-project/vllm-ascend.git\ncd vllm-ascend\n\nexport COMPILE_CUSTOM_KERNELS=1\npip install -e .\ncd ..\n")),(0,l.yg)("p",null,"\u5982\u679c\u5728\u5b89\u88c5 vllm-ascend \u65f6\u9047\u5230\u7c7b\u4f3c\u4ee5\u4e0b\u95ee\u9898\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"RuntimeError: CMake configuration failed: Command '['/pathto/miniconda3/envs/roll/bin/python3.10', '-m', 'pybind11', '--cmake']' returned non-zero exit status 2.\n")),(0,l.yg)("p",null,"\u53ef\u5c1d\u8bd5\u5728 vllm-ascend \u76ee\u5f55\u4e0b setup.py \u6587\u4ef6 151-158 \u884c\u8fdb\u884c\u5982\u4e0b\u4fee\u6539\u5e76\u91cd\u65b0\u8fdb\u884c\u7f16\u8bd1\uff1a"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},'try:\n    # if pybind11 is installed via pip\n    pybind11_cmake_path = (subprocess.check_output(\n        [python_executable, "-m", "pybind11",\n        "--cmakedir"]).decode().strip())\nexcept subprocess.CalledProcessError as e:\n    # else specify pybind11 path installed from source code on CI container\n    raise RuntimeError(f"CMake configuration failed: {e}")\n')),(0,l.yg)("h3",{id:"\u5b89\u88c5-roll"},"\u5b89\u88c5 ROLL"),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"git clone https://github.com/alibaba/ROLL.git\ncd ROLL\npip install -r requirements_common.txt\npip install deepspeed==0.16.0\ncd ..\n")),(0,l.yg)("h3",{id:"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e"},"\u5176\u4ed6\u4e09\u65b9\u5e93\u8bf4\u660e"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"software"),(0,l.yg)("th",{parentName:"tr",align:null},"description"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"transformers"),(0,l.yg)("td",{parentName:"tr",align:null},"v4.52.4")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"flash_attn"),(0,l.yg)("td",{parentName:"tr",align:null},"not supported")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"transformer-engine","[pytorch]"),(0,l.yg)("td",{parentName:"tr",align:null},"not supported")))),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"\u652f\u6301\u901a\u8fc7 transformers \u4f7f\u80fd --flash_attention_2\uff0c transformers \u9700\u7b49\u4e8e 4.52.4\u7248\u672c\u3002"),(0,l.yg)("li",{parentName:"ol"},"\u4e0d\u652f\u6301\u901a\u8fc7 flash_attn \u4f7f\u80fd flash attention \u52a0\u901f\u3002"),(0,l.yg)("li",{parentName:"ol"},"\u6682\u4e0d\u652f\u6301 transformer-engine","[pytorch]"," ")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"pip install transformers==4.52.4\n")),(0,l.yg)("h2",{id:"\u5feb\u901f\u5f00\u59cb\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15"},"\u5feb\u901f\u5f00\u59cb\uff0c\u5355\u8282\u70b9\u90e8\u7f72\u6307\u5f15"),(0,l.yg)("p",null,"\u6b63\u5f0f\u4f7f\u7528\u524d\uff0c\u5efa\u8bae\u60a8\u901a\u8fc7\u5bf9\u5355\u8282\u70b9\u6d41\u6c34\u7ebf\u7684\u8bad\u7ec3\u5c1d\u8bd5\u4ee5\u68c0\u9a8c\u73af\u5883\u51c6\u5907\u548c\u5b89\u88c5\u7684\u6b63\u786e\u6027\u3002\n\u7531\u4e8e\u76ee\u524d\u6682\u4e0d\u652f\u6301 Megatron-LM \u8bad\u7ec3\uff0c\u8bf7\u9996\u5148\u5c06\u5bf9\u5e94\u6587\u4ef6\u4e2d\nstrategy_args \u53c2\u6570\u4fee\u6539\u4e3a deepspeed \u9009\u9879\u3002"),(0,l.yg)("ol",null,(0,l.yg)("li",{parentName:"ol"},"\u4f7f\u7528 shell \u6267\u884c\u5355\u8282\u70b9\u6d41\u6c34\u7ebf")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"bash examples/agentic_demo/run_agentic_pipeline_frozen_lake_single_node_demo.sh  \n")),(0,l.yg)("ol",{start:2},(0,l.yg)("li",{parentName:"ol"},"\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u6267\u884c agentic pipeline")),(0,l.yg)("pre",null,(0,l.yg)("code",{parentName:"pre"},"# \u786e\u4fdd\u5f53\u524d\u4f4d\u4e8eROLL\u9879\u76ee\u76ee\u5f55\u7684\u6839\u76ee\u5f55\u4e0b\n# export PYTHONPATH=$(pwd):$PYTHONPATH\n\npython examples/start_agentic_pipeline.py \\\n        --config_path qwen2.5-0.5B-agentic \\\n        --config_name agentic_val_sokoban\n\n- ``--config_path`` \u2013 \u5305\u542b\u60a8\u7684YAML\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\u3002\n- ``--config_name`` \u2013 \u6587\u4ef6\u540d\uff08\u4e0d\u542b.yaml\u540e\u7f00\uff09\u3002\n")),(0,l.yg)("h2",{id:"\u652f\u6301\u73b0\u72b6"},"\u652f\u6301\u73b0\u72b6"),(0,l.yg)("table",null,(0,l.yg)("thead",{parentName:"table"},(0,l.yg)("tr",{parentName:"thead"},(0,l.yg)("th",{parentName:"tr",align:null},"Feature"),(0,l.yg)("th",{parentName:"tr",align:null},"Example"),(0,l.yg)("th",{parentName:"tr",align:null},"Training Backend"),(0,l.yg)("th",{parentName:"tr",align:null},"Inference Backend"),(0,l.yg)("th",{parentName:"tr",align:null},"Hardware"))),(0,l.yg)("tbody",{parentName:"table"},(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Agentic"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-0.5B-agentic/run_agentic_pipeline_sokoban.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"Agentic-Rollout"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-0.5B-agentic/run_agentic_rollout_sokoban.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"DPO"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-3B-dpo_megatron/run_dpo_pipeline.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")),(0,l.yg)("tr",{parentName:"tbody"},(0,l.yg)("td",{parentName:"tr",align:null},"RLVR"),(0,l.yg)("td",{parentName:"tr",align:null},"examples/qwen2.5-7B-rlvr_megatron/run_rlvr_pipeline.sh"),(0,l.yg)("td",{parentName:"tr",align:null},"DeepSpeed"),(0,l.yg)("td",{parentName:"tr",align:null},"vLLM"),(0,l.yg)("td",{parentName:"tr",align:null},"Atlas 900 A2 PODc")))),(0,l.yg)("h2",{id:"\u58f0\u660e"},"\u58f0\u660e"),(0,l.yg)("p",null,"ROLL \u4e2d\u63d0\u4f9b\u7684 Ascend \u652f\u6301\u4ee3\u7801\u7686\u4e3a\u53c2\u8003\u6837\u4f8b\uff0c\u751f\u4ea7\u73af\u5883\u4f7f\u7528\u8bf7\u901a\u8fc7\u5b98\u65b9\u6b63\u5f0f\u9014\u5f84\u6c9f\u901a\uff0c\u8c22\u8c22\u3002"))}y.isMDXComponent=!0},5680:(e,n,t)=>{t.d(n,{xA:()=>d,yg:()=>u});var a=t(6540);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){l(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function o(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var i=a.createContext({}),g=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):p(p({},n),e)),t},d=function(e){var n=g(e.components);return a.createElement(i.Provider,{value:n},e.children)},c="mdxType",y={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},s=a.forwardRef(function(e,n){var t=e.components,l=e.mdxType,r=e.originalType,i=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),c=g(t),s=l,u=c["".concat(i,".").concat(s)]||c[s]||y[s]||r;return t?a.createElement(u,p(p({ref:n},d),{},{components:t})):a.createElement(u,p({ref:n},d))});function u(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=t.length,p=new Array(r);p[0]=s;var o={};for(var i in n)hasOwnProperty.call(n,i)&&(o[i]=n[i]);o.originalType=e,o[c]="string"==typeof e?e:l,p[1]=o;for(var g=2;g<r;g++)p[g]=t[g];return a.createElement.apply(null,p)}return a.createElement.apply(null,t)}s.displayName="MDXCreateElement"}}]);